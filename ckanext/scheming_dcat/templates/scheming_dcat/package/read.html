{% extends "package/read.html" %}

{%  set schema = h.scheming_get_dataset_schema(dataset_type) %}

{% block primary_content_inner %}

  {{ super() }}

  {% set dataset_extent = h.get_pkg_dict_extra(c.pkg_dict, 'spatial', '') %}
  {% if dataset_extent %}
    {% snippet "spatial/snippets/dataset_map.html", extent=dataset_extent %}
  {% endif %}

{% endblock %}

{% block package_notes %}
  {%  if not dataset_type %}
    <p>
    dataset_type not passed to template. your version of CKAN
    might not be compatible with ckanext-scheming
    </p>
  {%  endif %}
  {% if (h.scheming_field_by_name(schema.dataset_fields, 'notes') or
    h.scheming_field_by_name(schema.dataset_fields, 'notes_translated')) and
    pkg.notes%}
    <div class="notes embedded-content">
      {{ h.render_markdown(h.get_translated(pkg, 'notes')) }}
    </div>
  {% endif %}
{% endblock %}

{% block package_additional_info %}
  {% snippet "scheming_dcat/package/snippets/additional_info.html",
    pkg_dict=pkg, dataset_type=dataset_type, schema=schema %}
{% endblock %}

{% block secondary_content %}
  {% block secondary_help_content %}{% endblock %}

  {% set dataset_extent = pkg.spatial %}
  {% if dataset_extent %}
    {% snippet "spatial/snippets/dataset_map_sidebar.html", extent=dataset_extent %}
  {% endif %}

  {% block package_info %}
    {% snippet 'package/snippets/info.html', pkg=pkg %}
  {% endblock %}

  {% block package_organization %}
    {% if pkg.organization %}
      {% set org = h.get_organization(pkg.organization.id) %}
      {% snippet "snippets/organization.html", organization=org, has_context_title=true %}
    {% endif %}
  {% endblock %}
  
  {% block package_publisher %}
     {% snippet "scheming_dcat/snippets/publisher_info.html", pkg=pkg, field_publisher_type=h.scheming_field_by_name(schema.dataset_fields, 'publisher_type'), field_spatial_uri=h.scheming_field_by_name(schema.dataset_fields, 'spatial_uri') %}
  {% endblock %}

  {% block package_social %}
    {% snippet "snippets/social.html" %}
  {% endblock %}

  {% block package_license %}
    {% snippet "snippets/license.html", pkg_dict=pkg %}
  {% endblock %}

  {% block package_access_rights %}
     {% snippet "scheming_dcat/snippets/access_rights.html", pkg=pkg, field=h.scheming_field_by_name(schema.dataset_fields, 'access_rights') %}
  {% endblock %}

{% endblock %}